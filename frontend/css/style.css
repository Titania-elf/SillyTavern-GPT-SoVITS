/* ========================================= */
/* é€šç”¨åŠ¨ç”» (æ ¸å¿ƒå¾‹åŠ¨é€»è¾‘ - æ‰€æœ‰é£æ ¼é€šç”¨) */
/* ========================================= */
.sovits-voice-waves {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 2px;
    width: 18px;
    height: 16px;
    flex-shrink: 0; /* é˜²æ­¢è¢«å‹ç¼© */
}

.sovits-voice-bar {
    width: 3px;
    border-radius: 2px;
    height: 6px;
    transition: background 0.3s, height 0.2s;
    background: #333;
    opacity: 0.8;
}

/* æ³¢æµªåŠ¨ç”»ï¼šå˜é«˜ + å˜äº® */
@keyframes sovits-wave-anim {
    0%, 100% { height: 6px; opacity: 0.5; }
    50% { height: 14px; opacity: 1; }
}

.voice-bubble.playing .sovits-voice-bar {
    animation: sovits-wave-anim 1s infinite ease-in-out;
}

/* âœ¨ æ³¢æµªå»¶è¿Ÿ (ä½ æ˜¯å¯¹çš„ï¼Œè¿™ä¸ªç»†èŠ‚å¾ˆæ£’) âœ¨ */
.voice-bubble.playing .sovits-voice-bar:nth-child(1) { animation-delay: 0.0s; }
.voice-bubble.playing .sovits-voice-bar:nth-child(2) { animation-delay: 0.15s; }
.voice-bubble.playing .sovits-voice-bar:nth-child(3) { animation-delay: 0.3s; }

/* Loading å‘¼å¸æ•ˆæœ */
@keyframes tts-pulse {
    0% {opacity:0.6;} 50% {opacity:1;} 100% {opacity:0.6;}
}


/* ========================================= */
/* é£æ ¼ 1: ç°ä»£é«˜çº§ (Default) - å·²ç˜¦èº« */
/* ========================================= */
body:not([data-bubble-style]) .voice-bubble,
body[data-bubble-style="default"] .voice-bubble {
    display: inline-flex; /* æ”¹ä¸º inline-flex æ›´å¥½èå…¥æ–‡æœ¬ */
    align-items: center;
    justify-content: space-between;
    vertical-align: middle; /* å‚ç›´å±…ä¸­å¯¹é½ */

    /* ğŸ“ å°ºå¯¸å‹ç¼©ï¼šä» 28px é™ä¸º 24px */
    height: 24px;
    padding: 0 10px; /* å‡å°å†…è¾¹è· */

    /* âœ‚ï¸ é—´è·æ§åˆ¶ï¼šä¸Šä¸‹ä¸º0ï¼Œå·¦è¾¹ç»™ä¸€ç‚¹ç‚¹ */
    margin: 0 0 0 4px;

    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 12px; /* åœ†è§’é…åˆé«˜åº¦ç¼©å° */
    backdrop-filter: blur(2px);
    min-width: 80px;
    gap: 6px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    font-size: 12px; /* å­—ä½“å¾®è°ƒ */
}

/* ç°ä»£ç‰ˆ - çŠ¶æ€é¢œè‰² */
body[data-bubble-style="default"] .voice-bubble[data-status="waiting"],
body:not([data-bubble-style]) .voice-bubble[data-status="waiting"] {
    background: #e0e0e0; border-color: #bdbdbd; color: #616161;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.03);
}
body[data-bubble-style="default"] .voice-bubble[data-status="ready"],
body:not([data-bubble-style]) .voice-bubble[data-status="ready"] {
    background: #dcedc8 !important; border-color: #aed581 !important; color: #33691e !important;
}
body[data-bubble-style="default"] .voice-bubble.playing,
body:not([data-bubble-style]) .voice-bubble.playing {
    background: linear-gradient(180deg, #f1f8e9 0%, #dcedc8 100%) !important;
    border-color: #9ccc65 !important; color: #1b5e20 !important;
    box-shadow: 0 2px 8px rgba(51, 105, 30, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.8) !important;
    transform: scale(1.01);
    font-weight: 600;
}
body[data-bubble-style="default"] .voice-bubble.loading,
body:not([data-bubble-style]) .voice-bubble.loading {
    background: #fff8e1; border-color: #ffe0b2; animation: tts-pulse 1.5s infinite;
}


/* ========================================= */
/* é£æ ¼ 2: ç»å…¸æ€€æ—§ (Classic) - æè‡´ç´§å‡‘ */
/* ========================================= */
body[data-bubble-style="classic"] .voice-bubble {
    display: inline-flex;
    align-items: center;
    justify-content: space-between;
    vertical-align: middle;

    /* ğŸ“ å°ºå¯¸å‹ç¼© */
    height: 22px;
    padding: 0 6px;
    margin: 0 2px; /* æå°å¤–è¾¹è· */

    border-radius: 4px;
    min-width: 40px;
    max-width: 250px;
    box-shadow: 0 1px 1px rgba(0,0,0,0.1);
    font-size: 12px;
    background: #c6e2b8;
    gap: 4px;
}
body[data-bubble-style="classic"] .voice-bubble:hover { filter: brightness(0.95); }
body[data-bubble-style="classic"] .voice-bubble.error { background: #ffcccc !important; border: 1px solid #ffaaaa; }
body[data-bubble-style="classic"] .voice-bubble.loading { opacity: 0.6; filter: grayscale(0.5); cursor: wait; }
body[data-bubble-style="classic"] .sovits-voice-bar { width: 2px; border-radius: 1px; }


/* ========================================= */
/* é£æ ¼ 3: è½»æ°§Â·å¾®ç å® (Airy Jewel) - 22px æè‡´ç‰ˆ */
/* ========================================= */

/* --- 0. åŸºç¡€æ„é€  --- */
body[data-bubble-style="kawaii"] .voice-bubble {
    display: inline-flex; /* å…³é”®ï¼šä¸ç‹¬å ä¸€è¡Œ */
    align-items: center;
    justify-content: space-between;
    vertical-align: middle; /* å…³é”®ï¼šå±…ä¸­å¯¹é½æ–‡å­— */
    gap: 6px;

    /* ğŸ“ æ ¸å¿ƒå°ºå¯¸ï¼šä» 24px å‹åˆ° 22pxï¼Œæåº¦ç²¾è‡´ */
    height: 22px;
    padding: 0 8px; /* å·¦å³ç¨å¾®æ”¶ä¸€ç‚¹ */
    margin: 0 2px;  /* ä¸Šä¸‹å¿…é¡»æ˜¯0ï¼Œé˜²æ­¢æ’‘å¼€è¡Œé«˜ */

    border-radius: 11px; /* é«˜åº¦çš„ä¸€åŠ */

    font-size: 12px;
    font-weight: 600;
    font-family: "Segoe UI", sans-serif;

    /* è´¨æ„Ÿ */
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    backdrop-filter: blur(4px);
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    border: 1px solid transparent;
}

/* 1. Waiting (é™æ­¢) - æœˆå…‰é“¶ */
body[data-bubble-style="kawaii"] .voice-bubble[data-status="waiting"] {
    background: linear-gradient(180deg, #fbfbfb 0%, #e8eaed 100%);
    color: #8890a0; /* é¢œè‰²å†æ·¡ä¸€ç‚¹ç‚¹ï¼Œæ›´æ˜¾é«˜çº§ */
    border-color: #e0e4e8;
    box-shadow: inset 0 1px 0 rgba(255,255,255,1), 0 1px 1px rgba(0,0,0,0.02);
}
body[data-bubble-style="kawaii"] .voice-bubble[data-status="waiting"]:hover {
    background: linear-gradient(180deg, #fff 0%, #f1f3f5 100%);
    color: #555;
    border-color: #cdd2d9;
    transform: translateY(-1px);
}

/* 2. Loading (åŠ è½½) - æµæ²™é‡‘ */
body[data-bubble-style="kawaii"] .voice-bubble.loading {
    background: #fffdf0;
    border-color: #ffe082;
    color: #fbc02d;
    animation: tts-shimmer 1.5s infinite alternate;
}
@keyframes tts-shimmer {
    0% { box-shadow: 0 0 0 rgba(255, 213, 79, 0); border-color: #ffe082; }
    100% { box-shadow: 0 0 6px rgba(255, 213, 79, 0.4); border-color: #ffca28; }
}

/* 3. Ready (å°±ç»ª) - è–„è·é’ */
body[data-bubble-style="kawaii"] .voice-bubble[data-status="ready"] {
    background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%) !important;
    color: #006064 !important;
    border: 1px solid #80deea !important;
    box-shadow: 0 1px 3px rgba(0, 150, 136, 0.15); /* é˜´å½±è°ƒå° */
}
body[data-bubble-style="kawaii"] .voice-bubble[data-status="ready"]:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(0, 150, 136, 0.2);
    background: linear-gradient(135deg, #e0f7fa 0%, #80deea 100%) !important;
}

/* 4. Playing (æ’­æ”¾) - å¹»å½©ç´« */
body[data-bubble-style="kawaii"] .voice-bubble.playing {
    background: linear-gradient(90deg, #b39ddb 0%, #f48fb1 100%) !important;
    color: #fff !important;
    border: 1px solid rgba(255,255,255,0.4) !important;
    text-shadow: 0 1px 1px rgba(0,0,0,0.1);
    box-shadow: 0 2px 6px rgba(179, 157, 219, 0.4) !important;
}
/* æ’­æ”¾æ—¶çš„å¾‹åŠ¨æ¡ï¼šçº¯ç™½ */
body[data-bubble-style="kawaii"] .voice-bubble.playing .sovits-voice-bar {
    background: rgba(255, 255, 255, 0.95);
    width: 2px;
    border-radius: 2px;
}

/* 5. Error (å‡ºé”™) - çŠç‘šçº¢ */
body[data-bubble-style="kawaii"] .voice-bubble.error {
    background: #ffebee !important;
    border: 1px solid #ef9a9a !important;
    color: #c62828 !important;
    box-shadow: none;
}


/* ========================================= */
/* åŒºåŸŸ B: æ§åˆ¶é¢æ¿ä¸æ‚¬æµ®çƒ */
/* ========================================= */
/* æ‚¬æµ®çƒ */
#tts-manager-btn {
    position: fixed; top: 10px; right: 100px; z-index: 20000;
    background: rgba(0,0,0,0.7); color: #fff; padding: 6px 12px;
    border-radius: 4px; cursor: pointer; border: 1px solid rgba(255,255,255,0.3);
    font-size: 13px; touch-action: none; user-select: none;
}
/* é€šçŸ¥æ¡ */
#tts-notification-bar {
    position: fixed; top: -50px; left: 50%; transform: translateX(-50%);
    z-index: 20005; background: #d32f2f; color: white;
    padding: 8px 20px; border-radius: 4px; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    font-size: 14px; transition: top 0.5s ease; pointer-events: none;
    display: flex; align-items: center; gap: 8px; width: 90%; justify-content: center;
}
#tts-notification-bar.show { top: 20px; }
/* é¢æ¿ä¸»ä½“ */
.tts-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6); z-index: 20001;
    display: flex;
}
.tts-panel {
    background: #2b2b2b; color: #eee;
    margin: auto; width: 95%; max-width: 500px; max-height: 75vh;
    border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    display: flex; flex-direction: column; overflow: hidden;
    border: 1px solid #444; font-family: sans-serif;
}
.tts-header {
    padding: 12px 15px; background: #222; border-bottom: 1px solid #444;
    display: flex; justify-content: space-between; align-items: center; flex-shrink: 0;
}
.tts-header h3 { margin: 0; font-size: 16px; }
.tts-close {
    background: none; border: none; color: #aaa; font-size: 24px;
    cursor: pointer; line-height: 1; padding: 0 5px;
}
.tts-content {
    padding: 15px; flex: 1; overflow-y: auto; min-height: 0;
    -webkit-overflow-scrolling: touch;
}
.tts-settings-zone input[type="text"] {
    background: #1a1a1a; border: 1px solid #444; color: #fff;
    padding: 4px; border-radius: 3px; margin-top: 2px;
}
.tts-add-zone, .tts-list-zone { margin-top: 15px; }

.tts-row, .tts-sub-row { display: flex; gap: 8px; margin-bottom: 8px; align-items: center; flex-wrap: wrap; }

.tts-row input, .tts-row select {
    flex: 1; background: #333; color: white; border: 1px solid #555; padding: 8px 5px;
    min-width: 100px;
}
.tts-list-container {
    border: 1px solid #444; background: #1f1f1f; max-height: 200px; overflow-y: auto;
    border-radius: 4px;
}
.tts-list-item {
    display: flex; justify-content: space-between; padding: 8px;
    border-bottom: 1px solid #333; align-items: center; font-size: 13px;
}
.tts-list-item:last-child { border-bottom: none; }
.col-name { font-weight: bold; color: #81c784; }
.col-model { color: #aaa; margin-left: 10px; flex: 1; word-break: break-all; }
.btn-blue { background: #1976d2; color: white; border: none; border-radius: 3px; cursor: pointer; padding: 6px 12px;}
.btn-red { background: #d32f2f; color: white; border: none; padding: 4px 10px; border-radius: 3px; cursor: pointer; }

/* ========================================= */
/* æ–°å¢ï¼šè‡ªå®šä¹‰ä¸‹æ‹‰èœå• (Custom Dropdown) */
/* ========================================= */

.tts-custom-select {
    position: relative;
    width: 100%;
    user-select: none;
    font-size: 13px;
    font-family: "Segoe UI", sans-serif;
}

/* --- 1. è§¦å‘å™¨ (æ²¡ç‚¹å¼€æ—¶çš„æ ·å­) --- */
.select-trigger {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background: #333; /* é»˜è®¤æ·±è‰²èƒŒæ™¯ */
    color: #eee;
    border: 1px solid #555;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    height: 36px;
    font-weight: 600;
}

.select-trigger:hover {
    border-color: #888;
}

.arrow-icon {
    font-style: normal;
    font-size: 10px;
    color: #aaa;
    transition: transform 0.3s;
}

/* å½“ä¸‹æ‹‰èœå•æ‰“å¼€æ—¶ï¼Œç®­å¤´æ—‹è½¬ */
.tts-custom-select.open .arrow-icon {
    transform: rotate(180deg);
}

/* --- 2. é€‰é¡¹åˆ—è¡¨å®¹å™¨ (é»˜è®¤éšè—) --- */
.select-options {
    position: absolute;
    top: 110%; /* åœ¨è§¦å‘å™¨ä¸‹æ–¹ */
    left: 0;
    width: 100%;
    background: #2b2b2b;
    border: 1px solid #444;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    z-index: 100;

    /* æ ¸å¿ƒï¼šéšè—é€»è¾‘ */
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);

    /* æ ¸å¿ƒï¼šæ»šåŠ¨æ¡ (è¶…è¿‡5ä¸ªé€‰é¡¹è‡ªåŠ¨æ»šåŠ¨) */
    max-height: 200px;
    overflow-y: auto;
}

/* æ‰“å¼€çŠ¶æ€ */
.tts-custom-select.open .select-options {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* --- 3. å•ä¸ªé€‰é¡¹æ ·å¼ --- */
.option-item {
    padding: 10px 12px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    transition: background 0.2s;
    color: #ccc;
}
.option-item:last-child { border-bottom: none; }
.option-item:hover { background: rgba(255,255,255,0.1); }


/* ========================================= */
/* ğŸ¨ æ ¸å¿ƒï¼šæ ¹æ®ä¸åŒå€¼æ˜¾ç¤ºä¸åŒçš®è‚¤ (å¤åˆ»ä¹‹å‰çš„é…è‰²) */
/* ========================================= */

/* --- ğŸŒ¿ Default: æ£®é‡ (é€‰ä¸­æ€ & é€‰é¡¹æ€) --- */
.select-trigger[data-value="default"],
.option-item[data-value="default"]:hover {
    background: #f1f8e9;
    color: #33691e;
    border-color: #dcedc8;
}

/* --- ğŸ“¼ Classic: æ—§æ—¥ (é€‰ä¸­æ€ & é€‰é¡¹æ€) --- */
.select-trigger[data-value="classic"],
.option-item[data-value="classic"]:hover {
    background: #c6e2b8;
    color: #2b2b2b;
    border-color: #99b88a;
    font-family: "Consolas", monospace;
}

/* --- ğŸ’ Kawaii: å¹»å½© (é€‰ä¸­æ€ & é€‰é¡¹æ€) --- */
.select-trigger[data-value="kawaii"] {
/* æ²¡ç‚¹å¼€æ—¶ï¼šæ˜¾ç¤ºè–„è·é’ (ä½ å–œæ¬¢çš„é‚£ä¸ª) */
    background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
    color: #006064;
    border-color: #80deea;
    text-shadow: none;
}
/* é¼ æ ‡åˆ’è¿‡é€‰é¡¹æ—¶ï¼šæ˜¾ç¤ºé…·ç‚«çš„ç´«ç²‰è‰² */
.option-item[data-value="kawaii"]:hover {
    background: linear-gradient(90deg, #b39ddb 0%, #f48fb1 100%);
    color: white;
    text-shadow: 0 1px 1px rgba(0,0,0,0.1);
}
